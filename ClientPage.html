<head>
    <link rel="stylesheet" href="ClientPage.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/6.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.6.2/firebase-storage.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/6.6.2/firebase-auth.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/6.6.2/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.6.2/firebase-database.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
             https://firebase.google.com/docs/web/setup#available-libraries -->

    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyCCkeCglasI9cz9KSrfgiTCMOzdgHNYhQM",
            authDomain: "webproject-66098.firebaseapp.com",
            databaseURL: "https://webproject-66098.firebaseio.com",
            projectId: "webproject-66098",
            storageBucket: "webproject-66098.appspot.com",
            messagingSenderId: "578047006972",
            appId: "1:578047006972:web:2fd6446310af9e46fc1f79",
            measurementId: "G-VK41Q22SD9"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var storageRef = firebase.storage().ref();
        var databaseRef = firebase.database().ref();
    </script>

</head>

<body>
    <script>
        $(document).ready(function () {
            firebase.auth().onAuthStateChanged(function (user) {
                var x;
                var currUID = firebase.auth().currentUser.uid;
                if (user) {
                    var child = storageRef.child('users-images/' + user.email + '');
                    child.getDownloadURL().then(function (url) {
                        document.getElementById("prof").src = url;
                    });
                    databaseRef.child('Coach/' + currUID).on("value", function (snapshot) {
                        $("#user-email").html(snapshot.val()["Username"]);
                    }, function (errorObject) {
                        console.log("The read failed: " + errorObject.code);
                    });
                    //Clients Request Button
                    databaseRef.child('Coach/' + currUID + "/New Client requests").on("value", function (snapshot) {
                        var name = ""
                        var uidN = ""
                        var counter = 0
                        if (snapshot.val() != null) {
                            for (var i = 0; i < Object.keys(snapshot.val()).length; i++) {
                                uidN = Object.keys(snapshot.val())[i]
                                if (snapshot.val()[uidN]["Status"] == "FALSE") {
                                    counter++;
                                }
                            }
                            if (counter > 99) {
                                $("#requestcounter").text(counter + "+")
                            }
                            else {
                                $("#requestcounter").text(counter);
                            }
                        }
                    }, function (errorObject) {
                        console.log("The read failed: " + errorObject.code);
                    });

                    //After Client request Accept 
                    databaseRef.child('Coach/' + currUID + "/Your Clients").on("value", function (snapshot) {
                        var name = ""
                        var uidN = ""
                        var optionsAsString = ""
                        if (snapshot.val() != null) {
                            for (var i = 0; i < Object.keys(snapshot.val()).length; i++) {
                                uidN = Object.keys(snapshot.val())[i]
                                optionsAsString += "<tr Client" + [i] + "'> <td >" + snapshot.val()[uidN]["Username"] + "</td><td>" + snapshot.val()[uidN]["Email"] + "</td> </td><td>" + snapshot.val()[uidN]["Age"] + "</td><td><button data-id='" + uidN + "'> Check it </button></td></tr> ";
                            }
                            $("#Clients").append(optionsAsString);
                            optionsAsString = ""
                        }

                    }, function (errorObject) {
                        console.log("The read failed: " + errorObject.code);
                    });

                } else {
                    alert("TL7s tizi msh zabt")
                }
            });
            //REQUESTS BUTTON
            $("#requestBtn").click(() => {
                document.location.href = "requestsACC.html"
            })




            //SIGN OUT BUTTON 
            $("#sgn-out").click(() => {
                firebase.auth().signOut().then(function () {
                    document.location.href = "LoginPage.html"
                }).catch(function (error) {
                    console.log(error);
                });
            })



        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>


    <header class="container-fluid">
        <div class="Toolbar">
            <img class="imggg" id="prof" src="" alt="">
            <label class="use-acc" id="user-email"></label>
            <button id="requestBtn" class="notification">
                Coach Name:
                <span class="badge" id="requestcounter"></span>
            </button>
            <button class="sgnout-btn" id="sgn-out">Sign out</button>
        </div>
    </header>
    <!-- Week Table -->
    <div class="row mt-100">
        <div class="col-1"></div>
        <table id="week" class="col-10">
            <tr>
                <th>Sunday</th>
                <th>Monday</th>
                <th>Tuesday</th>
                <th>Wednesday</th>
                <th>Thursday</th>
                <th>Friday</th>
                <th>Saturday</th>
            </tr>
            <tr>
                <td>
                    <p class="exercises">Muscle Group</p><input id="SundayMG" type="text" size="10">
                </td>
                <td>
                    <p class="exercises">Muscle Group</p><input id="MondayMG" type="text" size="10">
                </td>
                <td>
                    <p class="exercises">Muscle Group</p><input id="TuesdayMG" type="text" size="10">
                </td>
                <td>
                    <p class="exercises">Muscle Group</p><input id="WednesdayMG" type="text" size="10">
                </td>
                <td>
                    <p class="exercises">Muscle Group</p><input id="ThursdayMG" type="text" size="10">
                </td>
                <td>
                    <p class="exercises">Muscle Group</p><input id="FridayMG" type="text" size="10">
                </td>
                <td>
                    <p class="exercises">Muscle Group</p><input id="SaturdayMG" type="text" size="10">
                </td>
            </tr>
            <tr>
                <td>
                    <p class="exercises">exercises</p> <textarea id="SundayEX" rows="5" cols="10"></textarea>
                </td>
                <td>
                    <p class="exercises">exercises</p><textarea id="MondayEX" rows="5" cols="10"></textarea>
                </td>
                <td>
                    <p class="exercises">exercises</p><textarea id="TuesdayEX" rows="5" cols="10"></textarea>
                </td>
                <td>
                    <p class="exercises">exercises</p><textarea id="WednesdayEX" rows="5" cols="10"></textarea>
                </td>
                <td>
                    <p class="exercises">exercises</p><textarea id="ThursdayEX" rows="5" cols="10"></textarea>
                </td>
                <td>
                    <p class="exercises">exercises</p><textarea id="FridayEX" rows="5" cols="10"></textarea>
                </td>
                <td>
                    <p class="exercises">exercises</p><textarea id="SaturdayEX" rows="5" cols="10"></textarea>
                </td>
            </tr>
            <tr>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th><button id="workOutBTN">Click to update</button></th>
            </tr>
        </table>
        <div class="col-1"></div>
    </div>

    <!-- nutrition table -->

    <div class="row mt-100">
        <div class="col-2"></div>
        <table id="nutritionTBL" class="col-8">
            <tr>
                <th>Protine(g)</th>
                <th>Carbohydrates(g)</th>
                <th>Fats(g)</th>
                <th>Click to update Client Nutrition</th>
            </tr>
            <tr>
                <td> <input id="protine" type="number"> </td>
                <td><input id="carbohydrates" type="number"> </td>
                <td><input id="fats" type="number"> </td>
                <th><button id="submitNutr">Submit</button></th>
            </tr>
        </table>
        <div class="col-2"></div>
    </div>

    <!-- Client images -->
    <div class="ex1 mt-100">
        <table id="CheckTB">
            <tr>
                <th>Check UPS Pictures</th>
            </tr>
            <tr>
                <td> <button>Add Picture</button> </td>
            </tr>
            <tr>
                <td>
                    <img class="imgggCHECK" data-id="prof1" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof2" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof3" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof4" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof5" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof6" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof7" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof8" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof9" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof10" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof11" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof11" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof11" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">

                    <img class="imgggCHECK" data-id="prof11" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof11" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof11" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                    <img class="imgggCHECK" data-id="prof11" src="d:\Users\SHADI\Pictures\4K\4457.jpg" alt="">
                </td>
            </tr>
        </table>
    </div>
</body>

</html>